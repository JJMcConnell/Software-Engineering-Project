<div class="container" data-ng-controller="AuthenticationController">

    <center><h1>Requested Rooms</h1></center>

    <table ng-init="validateLogin()" class="table table-striped">
        <thead>
            <tr>
                <th>Room</th>
                <th>Period</th>
                <th>Request For</th>
                <th>Contact</th>
                <!-- <th>Room ID</th> -->
                <th>Submitted on</th>
                <th>Details</th>
                <th>Approve</th>
                <th>Deny</th>
            </tr>
        <tbody ng-init="fetchRequests()">
            
            <tr ng-repeat="reservation in events.slice().reverse()" id="tbl" ng-init="res = reserva;">
                <td ng-show="reservation.room"> {{ reservation.room }} </td>
                <td> {{ reservation.period }} </td>
                <td> {{ reservation.day }}-{{ reservation.month }}-{{ reservation.year }}</td>
                <td> {{ reservation.contactEmail}} </td>
                <!-- <td> {{ reservation.id }} </td> -->
                <td> {{ parseWeirdDate(reservation.created) }} </td>

                <td id="nameGoesHere" hidden="hidden" ng-init="title = reservation.title;">NAME!!!!!!!</td>

                <td>
                    <!--
                    provide additional details here with a modal (event title, desc, contact)
                    -->
                    <div ng-controller="ModalInfoCtrl">

                        <script type="text/ng-template" id="infomodal.html" ng-init="setInfo(reservation)">
                            <div class="modal-header">
                                <h3 class="modal-title">Event Information</h3>
                            </div>
                            <div id="innerInfo">
                                <ul>Title: {{ items.title }}</ul>
                                <ul>Email: {{ items.contactEmail }}</ul>
                                <ul>Phone Number: {{ items.contactPhone }}</ul>
                                <ul>Room : {{ items.room }}</ul>
                                <ul>Period : {{ items.period }}</ul>
                                <ul>Sponsor : {{ items.sponsor }}</ul>
                                <ul>Organization : {{ items.organization }}</ul>
                                <ul>Requested for: {{ items.day }}-{{ items.month }}-{{ items.year }}</ul>

                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-warning" ng-click="cancel()">Close</button>
                            </div>
                        </script>



                        <button ng-click="open()" class='btn btn-info'>
                            <span class="glyphicon glyphicon-info-sign"></span>
                        </button>

                    </div>

                </td>

                <td>

                    <!--
            1. make two forms: one for approving, one for denying
            2. have hidden fields for the room id for each form
            3. only submit the form whose button is pushed
            -->
                    <form action='approveroom'>
                        <input name='id' type="hidden" value="{{reservation._id}}">
                        <button type='submit' id='approve' class='btn btn-success' value=''>
                            <span class="glyphicon glyphicon-ok"></span>
                        </button>
                    </form>
                </td>
                <td>
                    <form action='denyroom'>
                        <input type='hidden' name='id' value="{{reservation._id}}">
                        <button type='submit' class='btn btn-danger' value='deny'>
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</div>
